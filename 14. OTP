#include <stdio.h>
#include <string.h>
#define MOD 26

int main() {
    char plain1[] = "SENDMOREMONEY";     
    int key1[] = {9,0,1,7,23,15,21,14,11,11,2,8,9}; 
    char cipher[50];
    char plain2[] = "CASHNOTNEEDED";    
    int newKey[50];
    int len = strlen(plain1);

    for(int i=0; i<len; i++)
        cipher[i] = ((plain1[i]-'A' + key1[i]) % MOD) + 'A';
    cipher[len] = '\0';

    printf("Part (a):\n");
    printf("Plaintext  : %s\n", plain1);
    printf("Ciphertext : %s\n\n", cipher);

    for(int i=0; i<len; i++)
        newKey[i] = (cipher[i]-'A' - (plain2[i]-'A') + MOD) % MOD;

    printf("Part (b):\n");
    printf("Target Plaintext : %s\n", plain2);
    printf("Ciphertext       : %s\n", cipher);
    printf("New Key          : ");
    for(int i=0; i<len; i++) printf("%d ", newKey[i]);
    printf("\n");
    return 0;
}
