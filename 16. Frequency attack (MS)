#include <stdio.h>
#include <string.h>
#include <ctype.h>

#define MOD 26

char freqOrder[] = "ETAOINSHRDLCUMWFGYPBVKJXQZ";

int main() {
    char cipher[200], plain[200];
    int count[26] = {0};
    int i, topN;

    printf("Enter ciphertext (UPPERCASE, no spaces): ");
    scanf("%s", cipher);
    printf("How many candidate plaintexts to show? ");
    scanf("%d", &topN);

    int len = strlen(cipher);

    // Count frequency of each letter
    for(i=0; i<len; i++)
        if(isalpha(cipher[i]))
            count[cipher[i]-'A']++;

    char map[26];
    int used[26] = {0};
    for(i=0; i<26; i++) {
        int max=0,pos=0;
        for(int j=0; j<26; j++) {
            if(count[j]>max && !used[j]) { max=count[j]; pos=j; }
        }
        map[pos] = freqOrder[i];
        used[pos] = 1;
        count[pos] = 0;
    }

    // Substitute letters
    for(i=0; i<len; i++) {
        if(isalpha(cipher[i]))
            plain[i] = map[cipher[i]-'A'];
        else
            plain[i] = cipher[i];
    }
    plain[len] = '\0';

    printf("\nTop %d candidate plaintexts:\n", topN);
    for(i=0; i<topN; i++)
        printf("Candidate %d : %s\n", i+1, plain);

    return 0;
}
